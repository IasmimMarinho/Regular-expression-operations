#Atividade proposta por Tiago Januario

from IPython.display import display, clear_output

if __name__ == '__main__':
  
  # Faz uma coleta inicial de Tweets
  token = ''

  # Geracao de Graficos
  y = np.array([0, 0, 0])
  labels = ["Lula", "Bolsonaro", "Ambos"]

  # Realiza 5 buscas no Twitter, altere essa quantidade como desejar
  buscas = 20
  for i in range(buscas):
    # Utiliza token para continuar buscando Tweets do último ponto de retorno
    tweets,token = main(token)  
    for t in tweets:
      plt.pause(0.5)
      plt.clf() 
      clear_output(wait=True)
      print(t)

      # Crie suas expressões regulares aqui!!!
      favoravel = re.search(".*lula.*",t,re.IGNORECASE)
      contrario = re.search(".*bolsonaro.*",t,re.IGNORECASE)
      indefinido = re.search("(lula|bolsonaro)",t,re.IGNORECASE)

      if favoravel and contrario==None:
        y[0] = y[0]+1
      elif contrario and favoravel==None:
        y[1] = y[1]+1
      else:
        y[2] = y[2]+1
      
      plt.pie(y, labels = labels,autopct='%1.1f%%')
      plt.show()

    if token == '':
      break
    
